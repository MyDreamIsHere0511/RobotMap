<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Robot Control and Map Viewer</title>
  <style>
    body {
      display: flex;
      justify-content: space-between;
      height: 100vh;
      margin: 0;
    }

    /* Phân khu 1: Điều khiển */
    .controls {
      width: 25%;
      padding: 10px;
      background-color: #f0f0f0;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .controls button {
      padding: 10px;
      font-size: 18px;
      cursor: pointer;
    }

    /* Phân khu 2: Nhập liệu */
    .input-container {
      width: 25%;
      padding: 10px;
      background-color: #f0f0f0;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .input-container input {
      padding: 8px;
      font-size: 16px;
    }

    /* Phân khu 3: Hiển thị bản đồ và robot */
    .map-container {
      width: 50%;
      height: 100%;
      position: relative;
      background-color: #fff;
      border: 2px solid #000;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .map-container img.map {
      width: 100%;
      height: 100%;
      object-fit: contain; /* Đảm bảo giữ tỷ lệ đúng cho ảnh */
    }

    .robot {
      position: absolute;
      width: 10%; /* Kích thước robot cố định */
      height: auto;
      transform-origin: center center; /* Đặt tâm quay ở giữa robot */
      display: none; /* Robot ẩn mặc định */
      transition: transform 0.3s ease-in-out, top 0.2s, left 0.2s;
    }

    /* Sử dụng media queries để thay đổi layout khi màn hình nhỏ hơn */
    @media (max-width: 768px) {
      body {
        flex-direction: column;
      }
      .controls, .input-container, .map-container {
        width: 100%;
      }
    }

  </style>
</head>
<body>

  <!-- Phân khu 1: Điều khiển -->
  <div class="controls">
    <h3>Điều khiển Robot</h3>
    <button onclick="move('up')">Tiến (W)</button>
    <button onclick="move('down')">Lùi (S)</button>
    <button onclick="move('left')">Trái (A)</button>
    <button onclick="move('right')">Phải (D)</button>
    <button onclick="toggleRobotVisibility()">Ẩn/Hiện Robot</button>
  </div>

  <!-- Phân khu 2: Nhập liệu -->
  <div class="input-container">
    <h3>Nhập liệu</h3>
    <div>
      <label for="rotateInput">Nhập góc quay (độ): </label>
      <input type="number" id="rotateInput" placeholder="Góc quay" />
      <button onclick="rotateRobot()">Quay Robot</button>
    </div>
  </div>

  <!-- Phân khu 3: Hiển thị bản đồ và robot -->
  <div class="map-container">
    <img src="map.png" alt="Map" class="map">
    <img src="robot.png" alt="Robot" id="robot" class="robot">
  </div>

  <script>
    // Đặt biến ban đầu cho robot và các khu vực
    const robot = document.getElementById('robot');
    const mapArea = document.querySelector('.map-container');
    let x = 50, y = 50; // Vị trí ban đầu robot (theo %)
    let rotation = 0; // Góc quay robot
    const step = 2; // Khoảng di chuyển mỗi lần

    const robotWidthInCm = 12; // Kích thước robot (cm)
    const robotHeightInCm = 16; // Kích thước robot (cm)
    const mapWidthInCm = 120; // Kích thước bản đồ (cm)
    const mapHeightInCm = 120; // Kích thước bản đồ (cm)

    // Cập nhật kích thước robot để phù hợp với bản đồ
    function updateRobotSize() {
      const mapWidth = mapArea.offsetWidth;
      const mapHeight = mapArea.offsetHeight;

      // Tính toán lại kích thước robot theo tỉ lệ
      const robotWidth = (mapWidth * (robotWidthInCm / mapWidthInCm));
      const robotHeight = (mapHeight * (robotHeightInCm / mapHeightInCm));

      robot.style.width = robotWidth + 'px';
      robot.style.height = robotHeight + 'px';
    }

    // Cập nhật lại kích thước robot mỗi khi load
    window.onload = updateRobotSize;
    window.onresize = updateRobotSize;

    // Di chuyển robot
    function move(direction) {
      if (robot.style.display === 'none') return;

      switch (direction) {
        case 'up': y = Math.max(0, y - step); break;
        case 'down': y = Math.min(100, y + step); break;
        case 'left': x = Math.max(0, x - step); break;
        case 'right': x = Math.min(100, x + step); break;
      }

      robot.style.left = `${x}%`;
      robot.style.top = `${y}%`;
    }

    // Quay robot
    function rotateRobot() {
      const angle = parseInt(document.getElementById('rotateInput').value);
      if (isNaN(angle)) return;
      rotation = angle;
      robot.style.transform = `translate(-50%, -50%) rotate(${rotation}deg)`;
    }

    // Ẩn/hiện robot
    function toggleRobotVisibility() {
      if (robot.style.display === 'none') {
        robot.style.display = 'block';
      } else {
        robot.style.display = 'none';
      }
    }

    // Điều khiển robot bằng các phím
    document.addEventListener('keydown', (e) => {
      switch (e.key.toLowerCase()) {
        case 'w': move('up'); break;
        case 's': move('down'); break;
        case 'a': move('left'); break;
        case 'd': move('right'); break;
      }
    });
  </script>
</body>
</html>
